var App;App=function(){class t{constructor(i,e,r,s,n,o,h,a){var l,p;this._fs=i,this._exec=e,this._path=r,this._mkdirp=s,this.utils=n,this.formatter=o,this.pageFactory=h,this.logger=a,l=t.outputTypesAdd.join("+")+(p=(p=t.outputTypesRemove.join("-"))?"-"+p:""),this.pandocOptions=[l?"-t "+l:"",t.extraOptions.join(" ")].join(" ")}convert(t,i){var e,r,s,n,o,h;for(r=this.utils.readDirRecursive(t),h=function(){var t,i,s;for(s=[],t=0,i=r.length;t<i;t++)(e=r[t]).endsWith(".html")&&s.push(this.pageFactory.create(e));return s}.call(this),s=[],n=0,o=h.length;n<o;n++)(e=>("index.html"===e.fileName&&s.push(this._path.join(e.space,"index")),this.convertPage(e,t,i,h)))(h[n]);return this.utils.isFile(t)||this.writeGlobalIndexFile(s,i),this.logger.info("Conversion done")}convertPage(t,i,e,r){var s,n;return this.logger.info("Parsing ... "+t.path),n=t.getTextToConvert(r),s=this._path.join(e,t.space,t.fileNameNew),this.logger.info("Making Markdown ... "+s),this.createFoldersStructure(e,t.space,t.pathToFolder),this.writeMarkdownFile(n,s),this.utils.copyAssets(this.utils.getDirname(t.path),this.utils.getDirname(s)),this.logger.info("Done\n")}writeMarkdownFile(t,i){var e,r,s,n;return r=this.utils.getDirname(i),this._mkdirp.sync(r,(function(t){if(t)return this.logger.error("Unable to create directory #{fullOutDirName}")})),n=i+"~",this._fs.writeFileSync(n,t,{flag:"w"}),e="pandoc -f html "+this.pandocOptions+" -o "+i+" "+n,(s=this._exec(e,{cwd:r})).status>0&&this.logger.error(s.stderr),this._fs.unlinkSync(n)}createFoldersStructure(t,i,e){var r,s,n,o,h,a;if(e){for(n in this._fs.existsSync(t)||this._fs.mkdirSync(t),o=this._path.join(t,i),this._fs.existsSync(o)||this._fs.mkdirSync(o),a=[],s=e.split("/").filter((function(t){return Boolean(t)})))r=s[n],h=(h=s[n-1])?h+"/":"",e=this._path.join(o,h+r),this._fs.existsSync(e)?a.push(void 0):a.push(this._fs.mkdirSync(e));return a}}writeGlobalIndexFile(t,i){var e,r,s;return r=this._path.join(i,"index.md"),e=this.formatter.createListFromArray(t),s=this.formatter.getHtml(e),this.writeMarkdownFile(s,r)}}return t.outputTypesAdd=["gfm","blank_before_header"],t.outputTypesRemove=[],t.extraOptions=["--atx-headers"],t}.call(this),module.exports=App;