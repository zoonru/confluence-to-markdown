var Page;Page=class{constructor(t,e,i){this.formatter=e,this.utils=i,this.path=t,this.init()}init(){return this.fileName=this.utils.getBasename(this.path),this.fileBaseName=this.utils.getBasename(this.path,".html"),this.filePlainText=this.utils.readFile(this.path),this.$=this.formatter.load(this.filePlainText),this.content=this.$.root(),this.heading=this.getHeading(),this.fileNameNew=this.getFileNameNew(),this.space=this.utils.getBasename(this.utils.getDirname(this.path)),this.spacePath=this.getSpacePath()}getSpacePath(){return"../"+this.utils.sanitizeFilename(this.space)+"/"+this.fileNameNew}getFileNameNew(){var t,e,i;return"index.html"===this.fileName?"index.md":(e=this.utils.sanitizeFilename(this.heading)+".md",(i=(t=this.content.find("#breadcrumbs")).find("li:not(.first)")).length?(this.pathToFolder=Array.from(i).reduce((function(e,i){return e+t.find(i).text().trim().replace(/[^A-Za-zА-Яа-я0-9]/g,"_")+"/"}),""),this.pathToFolder+e):e)}getHeading(){var t,e;return e=this.content.find("title").text(),"index.html"===this.fileName?e:(t=this.content.find("#breadcrumbs .first").text().trim(),e.replace(t+" : ",""))}getTextToConvert(t){var e;return e=this.formatter.getRightContentByFileName(this.content,this.fileName),e=this.formatter.fixHeadline(e),e=this.formatter.fixIcon(e),e=this.formatter.fixEmptyLink(e),e=this.formatter.fixEmptyHeading(e),e=this.formatter.fixPreformattedText(e),e=this.formatter.fixImageWithinSpan(e),e=this.formatter.removeArbitraryElements(e),e=this.formatter.fixArbitraryClasses(e),e=this.formatter.fixAttachmentWraper(e),e=this.formatter.fixPageLog(e),e=this.formatter.fixLocalLinks(e,this.space,t),e=this.formatter.addPageHeading(e,this.heading),this.formatter.getHtml(e)}},module.exports=Page;